10 GOSUB 1000 : ' Init
20 GOSUB 2000 : ' Menu display
30 WHILE quit = 0
40   GOSUB 3000 : ' Game loop
50 WEND
60 GOSUB 7000 ' End display
70 CLS : END


1000 '
1010 ' Init
1020 MODE 1
1030 DIM map(40, 24)
1040 quit = 0
1050 score = 0 : points = 0
1060 level = 0 : finalLevel = 3
1070 x=20 : y=12
1080 ' Custom characters
1090 ' Global vars:
1100 ' CHR_PLAYER = 248 : CHR_WALL = 207 : CHR_APPLE = 240
1110 ' APPLE_POINTS = 10
1120 '
1130 SYMBOL AFTER 200
1140 SYMBOL 240, &X100, &X1000, &X111100, &X1111110, &X11111111, &X11111111, &X1111110, &X111100 ' Apple
1150 SYMBOL 241, &X00000000, &X00000000, &X00000000, &X00011000, &X00011000, &X00000000, &X00000000, &X00000000 ' Point
1160 ' TODO: More characters
1170 '
1180 ' Display config
1190 BORDER 0
1200 INK 0,  0 :  ' Black background
1210 INK 1, 22 :  ' Green walls
1220 INK 2,  6 :  ' Red apples
1230 INK 3, 26 :  ' White player / Points
1500 RETURN


2000 '
2010 'Main display
2020 PEN 3
2030 LOCATE 16, 9 : PRINT "THE GAME"
2040 LOCATE 13, 14
2050 input "Name: ", nickname$
2500 RETURN


3000 '
3010 ' Game loop
3020 IF points = 0 THEN GOSUB 4000 : ' Next level
3030 LOCATE x, y : PEN 3 : PRINT CHR$(248)
3040 IF INKEY(69) <> -1 OR JOY(0) = 4 THEN LOCATE x, y: PRINT " " : x=x-1
3050 IF INKEY(61) <> -1 OR JOY(0) = 8 THEN LOCATE x, y: PRINT " " : x=x+1
3060 IF INKEY(59) <> -1 OR JOY(0) = 1 THEN LOCATE x, y: PRINT " " : y=y-1
3070 IF INKEY(60) <> -1 OR JOY(0) = 2 THEN LOCATE x, y: PRINT " " : y=y+1
3080 IF INKEY(67) <> -1 THEN quit = 1 : GOSUB 8200 : ' Q -> Quit
3090 IF map(x, y) = 1 THEN quit = 1  : GOSUB 8200 : ' Crash against wall
3100 IF map(x, y) = 2 THEN map(x, y) = 0 : score = score + 10 : points = points - 1 : LOCATE 1, 25 : PRINT "Score: "; score; : GOSUB 8100 : ' Get point
3110 IF map(x, y) = 3 THEN map(x, y) = 0 : score = score + 20 : LOCATE 1, 25 : PRINT "Score: "; score; : GOSUB 8400 : ' Captures apple
3500 RETURN


4000 '
4010 ' Print next level
4020 IF level = finalLevel THEN quit = 1 : RETURN ' Game completed
4030 GOSUB 8300
4040 x = 20 : y = 12
4050 level = level + 1
4060 GOSUB 6000 : ' Next level display
4070 GOSUB 5000 : ' Set read values and map printing
4080 RANDOMIZE TIME
4090 points = 7
4100 xItem = 1 : yItem = 1
4110 FOR i=1 TO points
4120   WHILE map(xItem, yItem) <> 0  ' Looking for a free position
4130     xItem = INT(RND*38) + 1 : yItem = INT(RND*22) + 1
4140   WEND
4150   LOCATE xItem, yItem : PEN 3 : PRINT CHR$(241); : map(xItem, yItem) = 2
4160 NEXT i
4170 FOR i=1 TO INT(RND*level)
4180   WHILE map(xItem, yItem) <> 0 ' Looking for a free position
4190     xItem = INT(RND*38) + 1 : yItem = INT(RND*22) + 1
4200   WEND
4210   LOCATE xItem, yItem : PEN 2 : PRINT CHR$(240); : map(xItem, yItem) = 3
4220 NEXT i
4500 RETURN


5000 '
5010 ' Set read values and map printing
5020 CLS
5030 PEN 3 : LOCATE 32, 25 : PRINT "Level:"; level;
5040 FOR row = 1 TO 24
5050   FOR column = 1 TO 40
5060     READ map(column, row)
5070     IF map(column, row) = 1 THEN LOCATE column, row : PEN 1 : PRINT CHR$(207);
5080     IF map(column, row) = 2 THEN LOCATE column, row : PEN 2 : PRINT CHR$(241);
5090     IF map(column, row) = 3 THEN LOCATE column, row : PEN 3 : PRINT CHR$(240);
5100   NEXT column
5110 NEXT row
5120 PEN 3 : LOCATE 1, 25 : PRINT "Score: "; score;
5500 RETURN


6000 '
6010 ' Level display
6020 FOR i=1 TO 1500: NEXT ' Sleep
6030 CLS
6040 LOCATE 16, 12 : PRINT "Level"; level
6050 LOCATE 1, 23
6060 FOR i=1 TO 2500: NEXT ' Sleep
6100 RETURN


7000 '
7010 ' End display
7020 FOR i=1 TO 1000: NEXT ' Sleep
7030 CLS
7040 LOCATE 13, 9 : PRINT "G A M E  O V E R"
7050 LOCATE 13, 13 : PRINT nickname$; " score: "; score
7060 LOCATE 13, 17 : PRINT "Play Again:  P"
7070 LOCATE 13, 18 : PRINT "New game:    N"
7080 LOCATE 13, 19 : PRINT "Exit:        Q"
7090 WHILE INKEY$ <> "": WEND ' Waiting until there are no keys in the buffer
7100 opt$ = INKEY$
7110 WHILE opt$ = ""
7120   opt$ = INKEY$
7130 WEND
7140 IF UPPER$(opt$) = "P" THEN quit = 0 : level = 0 : score = 0 : points = 0 : GOTO 30
7150 IF UPPER$(opt$) = "N" THEN quit = 0 : GOTO 1050
7500 RETURN


8000 ' SOUNDS 8000
8010 ' Note values: C=1, D=2, E=3, F=4, G=5, A=6, B=7

8100 ' Success sound
8120 FOR I=3 TO 5
8130   SOUND 1, 30 + 20 * i, 5, 8
8140 NEXT I
8150 RETURN

8200 ' Extra success sound
8210 FOR I=7 TO 1 STEP -2
8220   SOUND 1, 30 + 20 * i, 5, 8
8230   SOUND 3, 30 + 20 * i, 5, 8
8240 NEXT I
8250 RETURN

8300 ' Start sound
8310 FOR i = 7 TO 1 STEP -1
8320   SOUND 1, 20 + 10 * i, 5, 10
8330   SOUND 3, 20 + 10 * i, 5, 10
8340 NEXT i
8350 RETURN

8400 ' Apple eaten
8410 FOR I=1 TO 3
8420   SOUND 1, I*50+200, 10, 10
8430   SOUND 2, I*60+200, 10, 10
8440   SOUND 3, I*70+200, 10, 10
8450 NEXT I
8500 RETURN



10000 ' Map 1
10010 DATA 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
10020 DATA 1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
10030 DATA 1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
10040 DATA 1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
10050 DATA 1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
10060 DATA 1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1
10070 DATA 1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1
10080 DATA 1,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1
10090 DATA 1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1
10100 DATA 1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1
10110 DATA 1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
10120 DATA 1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
10130 DATA 1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
10140 DATA 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1
10150 DATA 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
10160 DATA 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
10170 DATA 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
10180 DATA 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
10190 DATA 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1
10200 DATA 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
10210 DATA 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
10220 DATA 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
10230 DATA 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
10240 DATA 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1

11000 ' Map 2
11010 DATA 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
11020 DATA 1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1
11030 DATA 1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1
11040 DATA 1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
11050 DATA 1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
11060 DATA 1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1
11070 DATA 1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1
11080 DATA 1,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1
11090 DATA 1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1
11100 DATA 1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1
11110 DATA 1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,1
11120 DATA 1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,1
11130 DATA 1,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,1
11140 DATA 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,0,0,0,1,0,0,0,0,0,0,0,1
11150 DATA 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
11160 DATA 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
11170 DATA 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
11180 DATA 1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
11190 DATA 1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1
11200 DATA 1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1
11210 DATA 1,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1
11220 DATA 1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
11230 DATA 1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
11240 DATA 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1

12000 ' Map 3
12010 DATA 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
12020 DATA 1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1
12030 DATA 1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1
12040 DATA 1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
12050 DATA 1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1
12060 DATA 1,0,0,0,0,0,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1
12070 DATA 1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1
12080 DATA 1,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1
12090 DATA 1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1
12100 DATA 1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1
12110 DATA 1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,1
12120 DATA 1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,1
12130 DATA 1,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,1
12140 DATA 1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,0,0,0,0,0,0,0,1
12150 DATA 1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
12160 DATA 1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
12170 DATA 1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1
12180 DATA 1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1
12190 DATA 1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1
12200 DATA 1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,1
12210 DATA 1,1,1,1,1,1,1,0,0,1,1,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,1
12220 DATA 1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
12230 DATA 1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1
12240 DATA 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1
